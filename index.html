<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Monthly Transaction</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap');

body{
  font-family:'Inter', sans-serif;
  background:linear-gradient(135deg,#eef2f7,#f9fafb);
  padding:20px;
}

form{
  background:#ffffff;
  max-width:440px;
  margin:auto;
  padding:22px;
  border-radius:16px;
  box-shadow:0 18px 40px rgba(0,0,0,.08);
}

h3{
  text-align:center;
  margin-bottom:16px;
  font-weight:600;
}

label{
  font-size:13px;
  font-weight:600;
  display:block;
  margin-top:14px;
  color:#374151;
}

input, select{
  width:100%;
  height:44px;
  margin-top:6px;
  padding:0 12px;
  box-sizing:border-box;
  border-radius:10px;
  border:1px solid #d1d5db;
  font-size:14px;
}

input:focus, select:focus{
  outline:none;
  border-color:#6366f1;
  box-shadow:0 0 0 3px rgba(99,102,241,.15);
}

button{
  width:100%;
  height:46px;
  background:#6366f1;
  color:#fff;
  border:none;
  border-radius:12px;
  margin-top:22px;
  font-size:15px;
  font-weight:600;
  cursor:pointer;
}

button:hover{background:#4f46e5}

.hidden{display:none}
input:disabled{background:#f3f4f6}
</style>
</head>

<body>

<form id="txnForm">
  <h3>Monthly Transaction</h3>

  <label>Date</label>
  <input type="date" id="date" required>

  <label>Narration</label>
  <input type="text" id="narration" required>

  <label>Purpose</label>
  <select id="purpose">
    <option value="">Select</option>
    <option>Groceries</option>
    <option>Food</option>
    <option>Travel</option>
    <option>Rent</option>
    <option>Utilities</option>
    <option>Shopping</option>
    <option>Medical</option>
    <option>Entertainment</option>
    <option>Investment</option>
    <option>Other</option>
  </select>
  <input type="text" id="purpose_other" class="hidden" placeholder="Enter purpose">

  <label>Spent for / Earned by</label>
  <select id="spent_for">
    <option value="">Select</option>
    <option>Self</option>
    <option>Family</option>
    <option>Wife</option>
    <option>Parents</option>
    <option>Friends</option>
    <option>Office</option>
    <option>Other</option>
  </select>
  <input type="text" id="spent_for_other" class="hidden" placeholder="Enter name">

  <label>Transaction Flow</label>
  <select id="flow" required>
    <option value="">Select</option>
    <option value="withdraw">Withdraw</option>
    <option value="deposit">Deposit</option>
  </select>

  <label>Transaction Type</label>
  <select id="trtype" required>
    <option value="">Select</option>
    <option value="cash">Cash</option>
    <option value="debit">Debit</option>
    <option value="upi">UPI</option>
    <option value="net">Net</option>
    <option value="credit">Credit</option>
  </select>

  <div id="accountBlock" class="hidden">
    <label>Account</label>
    <select id="account"></select>
  </div>

  <!-- Amounts (HIDDEN INITIALLY) -->
  <div id="withdrawBlock" class="hidden">
    <label>Withdrawn Amount</label>
    <input type="number" id="withdrawn" step="0.01">
  </div>

  <div id="depositBlock" class="hidden">
    <label>Deposit Amount</label>
    <input type="number" id="deposit" step="0.01">
  </div>

  <button type="submit">Save Transaction</button>
</form>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwInKOM9oS6ZimUafm-J5i-6rINe0aLvfJ_5BRP_jS_gKagApXbnxEFKu5rikhd3FnV/exec";

  /* Date formatter */
function formatDate(dateStr){
  const d = new Date(dateStr);
  const day = String(d.getDate()).padStart(2,'0');
  const month = d.toLocaleString('en-US',{month:'short'});
  return `${day}-${month}-${d.getFullYear()}`;
}
/* DOM */
const date = document.getElementById("date");
const narration = document.getElementById("narration");
const purpose = document.getElementById("purpose");
const purposeOther = document.getElementById("purpose_other");
const spentFor = document.getElementById("spent_for");
const spentForOther = document.getElementById("spent_for_other");
const flow = document.getElementById("flow");
const trtype = document.getElementById("trtype");
const accountBlock = document.getElementById("accountBlock");
const account = document.getElementById("account");
const withdrawBlock = document.getElementById("withdrawBlock");
const depositBlock = document.getElementById("depositBlock");
const withdrawn = document.getElementById("withdrawn");
const deposit = document.getElementById("deposit");

/* Accounts */
const bankAccounts = ["FI","HDFC Old","HDFC New","ICICI","RBL","Kotak","SBI","IndusInd"];
const creditCards = [
  "Axis Flipkart","Axis MyZone","Axis Neo","HDFC PhonePe","HDFC Tata Neu",
  "HDFC Millennia","HSBC","IDFC First Millenia","ICICI Amazon","ICICI Coral",
  "ICICI Expressions","Indusind Plat Aura EDGE","Indusind Legend",
  "Yes Finbooster","Kotak League","Kotak Image","SBI BPCL","Standard Chartered"
];

/* Other logic */
purpose.addEventListener("change",()=>purposeOther.classList.toggle("hidden",purpose.value!=="Other"));
spentFor.addEventListener("change",()=>spentForOther.classList.toggle("hidden",spentFor.value!=="Other"));

/* Account logic */
trtype.addEventListener("change",()=>{
  account.innerHTML="";
  if(trtype.value==="cash"){accountBlock.classList.add("hidden");return;}
  accountBlock.classList.remove("hidden");
  const list=trtype.value==="credit"?creditCards:bankAccounts;
  list.forEach(a=>account.add(new Option(a,a)));
});

/* âœ… Amount visibility FIX */
flow.addEventListener("change",()=>{
  withdrawBlock.classList.add("hidden");
  depositBlock.classList.add("hidden");
  withdrawn.value="";
  deposit.value="";
  withdrawn.disabled=false;
  deposit.disabled=false;

  if(flow.value==="withdraw"){
    withdrawBlock.classList.remove("hidden");
    deposit.disabled=true;
  }

  if(flow.value==="deposit"){
    depositBlock.classList.remove("hidden");
    withdrawn.disabled=true;
  }
});

/* Submit */
document.getElementById("txnForm").addEventListener("submit",e=>{
  e.preventDefault();

  if(trtype.value!=="cash" && !account.value){
    alert("Please select an account");
    return;
  }

  const payload=new URLSearchParams({
    category:"monthly transactions",
    date:date.value,
    narration:narration.value,
    purpose:purpose.value==="Other"?purposeOther.value:purpose.value,
    spent_for:spentFor.value==="Other"?spentForOther.value:spentFor.value,
    trtype:trtype.value,
    from_to:trtype.value==="cash"?"Cash":account.value,
    withdrawn:withdrawn.value,
    deposit:deposit.value
  });

  fetch(SCRIPT_URL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:payload})
  .then(()=>{
    alert("Transaction saved successfully");
    e.target.reset();
    accountBlock.classList.add("hidden");
    withdrawBlock.classList.add("hidden");
    depositBlock.classList.add("hidden");
    purposeOther.classList.add("hidden");
    spentForOther.classList.add("hidden");
  })
  .catch(()=>alert("Error saving transaction"));
});
</script>

</body>
</html>


